/*
Com o GameObject "Inimigo" já criado, tu vai adicionar esse Script a ele.
(Lembre-se de adicionar a Tag "Player" ao jogador)
Com o script já adicionado, tu vai abrir o spector do player, e na parte do script vai estar pedindo o "machado",
dai tu vai criar um prefab qualquer, um cubo sla, e vai adicionar a esse "None()"
e depois tu vai testar pra ver se ta tudo funcionando como deveria.
*/

EnemyAttack : Behaviour

Transform alvo; //alvo do inimigo
public float range = 15.0f; //área de ataque
public GameObject machado; //objeto que o inimigo atira.
public Transform shootPoint; //ponto de onde sai esse objeto.
public float speedShoot = 5.0f; //velocidade do tiro
bool isShooting; //se o inimigo ta atirando ou nao.

void Start()
{
  alvo = GameObject.FindGameObjectWhitTag("Player").Transform; //tu vai criar uma tag chamada Player e colocar no jogador;
}

void Update()
{
  //rotação do inimigo
  Vector3 dir = alvo.position - transform.position;
  Quaternion lookRotation = Quaternion.lookRotation(dir);
  Vector3 rotation = lookRotation.EulerAngles;
  Inimigo.rotation = lookRotation;
  
  //atirar
  float distance = Vector3.Distance(transform.position, alvo.position);
  if(distance <= 15)
  {
    if(!isShooting)
    {
    InvokeRepeating("Shoot", 0f, 0.2f)
    isShooting = true;
    }  
  }
  else
  {
    CancelInvoke("Shoot");
    isShooting = false;
  }
}

void OnDrawGizmosSelected() //range de ataque do inimigo
{
  Gizmos.color = red;
  Gizmos.DrawWireSphere(transform.position,range);
}

void Shoot() //tiro
{
  Instantiate(machado, shootPoint.position, shootPoint.rotation * speedShoot);
}
